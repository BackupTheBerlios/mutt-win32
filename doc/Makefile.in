SHELL=/bin/sh

PACKAGE=@PACKAGE@
VERSION=@VERSION@

prefix=@prefix@
exec_prefix=@exec_prefix@
bindir=@bindir@
libdir=@libdir@
mandir=@mandir@
sharedir=@sharedir@
srcdir=@srcdir@
docdir=@docdir@
top_srcdir=@top_srcdir@
top_builddir=..
VPATH=@srcdir@
@SET_MAKE@

INSTALL=@INSTALL@
CC=@CC@
XCPPFLAGS=-I. @CPPFLAGS@
CFLAGS=@CFLAGS@ -DSHAREDIR=\"$(sharedir)\" $(XCPPFLAGS)
LDFLAGS=@LDFLAGS@

DISTFILES = Makefile.in PGP-Notes.txt dotlock.man.in \
	manual.sgml manual.txt mutt.man.in style-guide

subdir = doc

complete: all html

all: mutt.man dotlock.man manual.txt 

html: manual.html

install: dotlock.man mutt.man manual.txt
	$(top_srcdir)/mkinstalldirs $(mandir)/man1
	$(INSTALL) -m 644 mutt.man $(mandir)/man1/mutt.1
	$(INSTALL) -m 644 dotlock.man $(mandir)/man1/mutt.dotlock.1
	$(top_srcdir)/mkinstalldirs $(docdir)
	$(INSTALL) -m 644 manual.txt $(docdir)
	$(INSTALL) -m 644 PGP-Notes.txt $(docdir)

mutt.man: mutt.man.in
	(cd .. ; ./config.status)

dotlock.man: dotlock.man.in
	(cd .. ; ./config.status)

uninstall:
	-rm -f $(mandir)/man1/mutt.1 $(docdir)/manual.txt	\
		$(docdir)/PGP-Notes.txt

manual.txt: manual.sgml
	sgml2txt -c latin manual

manual.html: manual.sgml
	sgml2html manual

clean: 
	rm -f *~ *.html *.orig *.rej *.man

clean-real:
	rm -f manual.txt

maintainer-clean: clean clean-real

distclean: clean
	rm -f Makefile

Makefile: Makefile.in ../config.status
	cd .. \
	  && CONFIG_FILES=$(subdir)/$@ CONFIG_HEADERS= $(SHELL) ./config.status

distdir = ../$(PACKAGE)-$(VERSION)/$(subdir)
dist distdir: Makefile $(DISTFILES)
	for file in $(DISTFILES) ; do				\
		ln $(srcdir)/$$file $(distdir) 2> /dev/null 	\
			|| cp -p $(srcdir)/$$file $(distdir); 	\
	done
			
